!function(){"use strict";var t;t=function(){var t="<style>.RETICOOL{position:fixed;top: 0;left:0;pointer-events:none;will-change:transform;transition: color 0.3s linear,opacity 0.3s linear;font-size: 20px;line-height:1;white-space:nowrap;z-index:9999999} .RETICOOL__inner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);} .RETICOOL__circle{border-style:solid;}</style>",i=CSS&&CSS.supports&&CSS.supports("transform","rotate(calc(1*1rad))");function s(t={}){if(!(this instanceof s))return new s(t);this.config=Object.assign({},{cursor:"crosshair",radius:80,borderWidth:3,color:"#49D292",opacity:.85,ease:.2,lockTriggers:"[data-lock], a, button",lockColor:"#E8F79A",lockOpacity:.99,lockClass:null,lockTravel:.15,lockExpand:20,lockEase:.3,content:"+",useCSSVars:!0},t),this.opts=t,this.x=this.lx=this._x=this.x||window.innerWidth/2,this.y=this.ly=this._y=this.y||window.innerHeight/2,this.init()}function o(t,i,s){return t+(i-t)*s}var e=Element.prototype,h=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;function n(t,i){var s=null;return function(){var o=this,e=arguments;null===s&&(s=setTimeout(function(){t.apply(o,e),s=null},i))}}return s.prototype={constructor:s,width:0,height:0,dx:0,dy:0,timestamp:null,init(){for(var s in t&&(document.head.insertAdjacentHTML("afterbegin",t),t=null),this.config.cursor&&(document.documentElement.style.cursor=this.config.cursor),this.$=this.$||document.createElement("div"),this.$.className="RETICOOL",this.setColor(this.config.color,this.config.opacity),this.$c=document.createElement("div"),this.$c.className="RETICOOL__circle",this.$c.style.width=`${this.config.radius}px`,this.$c.style.height=`${this.config.radius}px`,this.$c.style.borderRadius=`${this.config.radius}px`,this.$c.style.borderWidth=`${this.config.borderWidth}px`,this.$i=document.createElement("div"),this.$i.className="RETICOOL__inner",this.$i.innerHTML=this.config.content,this.$c.appendChild(this.$i),this.$.appendChild(this.$c),this.onUpdate=this.onUpdate||this.updateStyle,this.config.useCSSVars&&i&&this.activateCSSVars(),this.timestamp=Date.now(),this)this[s]&&this[s].bind&&(this[s]=this[s].bind(this));this.scrollUnlock=n(this.unlock,100),this.onHover=n(this.onHover,100),this.attach(),this.update()},events(t){const i=`${t?"remove":"add"}EventListener`;document[i]("mousemove",this.onMove),document[i]("touchstart",this.onMove),document[i]("touchmove",this.onMove),document[i]("touchend",this.onMove),this.opts.content||document[i]("keydown",this.changeSymbol),document.documentElement[i]("mousedown",this.onDown),document.documentElement[i]("touchstart",this.onDown),document.documentElement[i]("mouseup",this.onUp),document.documentElement[i]("touchend",this.onUp),window[i]("scroll",this.scrollUnlock)},attach(){this.events(),document.body.appendChild(this.$)},destroy(){this.events(!0),this.$.parentNode.removeChild(this.$)},setColor(t,i){this.$.style.color=t,this.$.style.opacity=i},onDown:function(){this.down=!0},onUp:function(){this.down=!1},onMove:function(t){t=t.touches?t.touches[0]:t,this._x=t.clientX,this._y=t.clientY,this.onHover(t)},onHover:function(t){if(this.config.lockTriggers){var i=t.target;if(i!==this.lockTarget){for(;i!==document.documentElement&&i.parentNode;){if(s=i,o=this.config.lockTriggers,h&&h.call(s,o))return void this.lock(i);i=i.parentNode}this.lockTarget&&this.unlock(),this.lockTarget=null}}var s,o},update:function(){requestAnimationFrame(this.update);var t,i,s,e,h,n,c=this._x,r=this._y;this.locked&&this.lockx&&this.locky&&(c=this.lockx-(this.lockx-c)*this.config.lockTravel,r=this.locky-(this.locky-r)*this.config.lockTravel),this.x=o(this.x,c,this.config.ease),this.y=o(this.y,r,this.config.ease),this.locked?(this.rotation=0,h=0,n=0):(h=this.x-this.lx,n=this.y-this.ly),this.dx=Math.floor(100*o(this.dx,h,this.config.ease))/100,this.dy=Math.floor(100*o(this.dy,n,this.config.ease))/100,e=(s=Date.now())-this.timestamp,this.timestamp=s,this.vx=Math.min(Math.abs(this.dx)/e,2),this.vy=Math.min(Math.abs(this.dy)/e,2),this.rotation=this.locked?0:Math.atan2(this.dy,this.dx),t=this.lockWidth?this.lockWidth:this.config.radius,i=this.lockHeight?this.lockHeight:this.config.radius,this.down&&(t-=10,i-=10),this.width=Math.round(10*o(this.width,t,this.config.lockEase))/10,this.height=Math.round(10*o(this.height,i,this.config.lockEase))/10,this.lx=this.x,this.ly=this.y,this.onUpdate(this)},activateCSSVars(){this.$.style.transform="translate( calc( var(--dx) * -1px ), calc( var(--dy) * -1px ) ) translate3d( calc( var(--x) * 1px ), calc( var(--y) * 1px ), 0px )",this.$c.style.transform="translate3d( -50%, -50%, 0px ) translate( calc( var(--vx) * -4% ), calc( var(--vy) * -4% ) ) rotate( calc( var(--rotation) * 1rad) ) scaleX( calc( var(--vx)/2 + var(--vy)/2 + 1 ) )",this.$c.style.width="calc( var(--width) * 1px )",this.$c.style.height="calc( var(--height) * 1px )",this.$i.style.transform="translate(-50%, -50%) rotate(calc( var(--rotation) * -1rad) ",this.onUpdate=this.updateCSSVars},updateCSSVars:function(){this.$.style.setProperty("--width",this.width),this.$.style.setProperty("--height",this.height),this.$.style.setProperty("--x",this.x),this.$.style.setProperty("--y",this.y),this.$.style.setProperty("--vx",this.vx),this.$.style.setProperty("--vy",this.vy),this.$.style.setProperty("--dx",this.dx),this.$.style.setProperty("--dy",this.dy),this.$.style.setProperty("--rotation",this.rotation)},updateStyle:function(){this.$.style.transform="translate3d("+(this.x+-1*this.dx)+"px,"+(this.y+-1*this.dy)+"px, 0px)",this.$c.style.transform="translate3d("+(-50-4*this.vx)+"%, "+(-50-4*this.vy)+"%, 0px) rotate("+this.rotation+"rad) scaleX("+(this.vx/2+this.vy/2+1)+")",this.$i.style.transform=`translate(-50%, -50%) rotate(${-this.rotation}rad)`,this.$c.style.width=`${this.width}px`,this.$c.style.height=`${this.height}px`},changeSymbol:function(t){const i=["+","[ &nbsp; &nbsp; ]","❪ &nbsp; ❫","❮ &nbsp; ❯","⎔","▿","•","△","▽","✕","◇","⏚","⏛"];this.innerHTML=i[((t,i)=>(t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t+1))+t))(0,i.length-1)]},lock(t,i,s,o){if(void 0!==t){if(this.locked=!0,this.setColor(this.config.lockColor,this.config.lockOpacity),this.config.lockClass&&this.$.classList.add(this.config.lockClass),null==i&&t.getBoundingClientRect()){this.lockTarget=t;var e=t.getBoundingClientRect();s=Math.round(e.right-e.left),o=Math.round(e.bottom-e.top),t=e.left+s/2,i=e.top+o/2,this.down=!1}return this.lockx=t,this.locky=i,void(!1!==this.config.lockExpand&&(this.lockWidth=s+this.config.lockExpand,this.lockHeight=o+this.config.lockExpand))}this.unlock()},unlock(){this.locked&&(this.config.lockClass&&this.$.classList.remove(this.config.lockClass),this.lx=this.x,this.ly=this.y,this.setColor(this.config.color,this.config.opacity)),this.lockWidth=0,this.lockHeight=0,this.lockx=0,this.locky=0,this.rotation=0,this.locked=!1}},Object.defineProperties(s.prototype,{innerHTML:{get:function(){return this.config.content},set:function(t){return this.config.content=t,this.$i&&(this.$i.innerHTML=t),t}}}),s},"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():window.RETICOOL=t()}();
